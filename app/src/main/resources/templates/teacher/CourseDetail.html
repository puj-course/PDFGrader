<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8"><title>Detalle curso</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/course-detail.css}">
</head>
<body>
<div class="scene">
    <main class="shell">
        <section class="card pop">
            <header class="header">
                <h2 class="title" th:text="${course.code} + ' - ' + ${course.name}"></h2>
                <a th:href="@{/teacher/portal}" class="btn ghost">Volver al portal</a>
            </header>

            <div class="grid">
                <div class="panel">
                    <h3>Alumnos inscritos</h3>
                    <ul class="list">
                        <li th:each="s : ${students}" th:text="${s.fullName} + ' (' + ${s.email} + ')'"></li>
                        <li th:if="${#lists.isEmpty(students)}">Sin alumnos</li>
                    </ul>

                    <h3>Tareas</h3>
                    <ul class="list">
                        <li th:each="a : ${assignments}" class="row">
                            <a th:href="@{|/teacher/assignment/${a.id}|}" th:text="${a.title}"></a>
                            <span class="meta" th:text="${a.dueAt}"></span>
                        </li>
                        <li th:if="${#lists.isEmpty(assignments)}">Sin tareas aún</li>
                    </ul>
                </div>

                <div class="panel">
                    <h3>Subir Temario (PDF)</h3>
                    <form th:action="@{/teacher/upload-syllabus}" method="post" enctype="multipart/form-data" class="form">
                        <input type="hidden" name="courseId" th:value="${course.id}"/>
                        <label class="field"><span>Título (opcional)</span><input type="text" name="title"/></label>
                        <label class="field"><span>PDF</span><input type="file" name="file" accept="application/pdf" required/></label>
                        <button type="submit" class="btn primary">Subir temario</button>
                    </form>
                    <h4>Temarios existentes</h4>
                    <ul class="list">
                        <li th:each="sy : ${syllabi}" th:text="${#strings.defaultString(sy.title, 'Temario')}"></li>
                        <li th:if="${#lists.isEmpty(syllabi)}">Sin temarios</li>
                    </ul>

                    <hr/>

                    <h3>Subir Rúbrica (PDF)</h3>
                    <form th:action="@{/teacher/upload-rubric}" method="post" enctype="multipart/form-data" class="form">
                        <input type="hidden" name="courseId" th:value="${course.id}"/>
                        <label class="field"><span>Nombre</span><input type="text" name="name" required/></label>
                        <label class="field"><span>Versión</span><input type="number" name="version" required/></label>
                        <label class="field"><span>PDF</span><input type="file" name="file" accept="application/pdf" required/></label>
                        <button type="submit" class="btn primary">Subir rúbrica</button>
                    </form>
                    <h4>Rúbricas existentes</h4>
                    <ul class="list">
                        <li th:each="rb : ${rubrics}" th:text="${rb.name}"></li>
                        <li th:if="${#lists.isEmpty(rubrics)}">Sin rúbricas</li>
                    </ul>
                </div>
            </div>

            <hr/>

            <h3>Crear tarea</h3>
            <form th:action="@{|/teacher/course/${course.id}/assignment|}" method="post" th:object="${form}" class="form">
                <div class="cols">
                    <label class="field"><span>Título</span><input type="text" th:field="*{title}" required/></label>
                    <label class="field"><span>Fecha límite</span><input type="datetime-local" th:field="*{dueAt}"/></label>
                </div>
                <label class="field"><span>Descripción</span><textarea th:field="*{description}"></textarea></label>
                <div class="cols">
                    <label class="field"><span>Rúbrica</span>
                        <select th:field="*{rubricId}" required>
                            <option th:each="rb : ${rubrics}" th:value="${rb.id}" th:text="${rb.name}"></option>
                        </select>
                    </label>
                    <label class="field"><span>Temario (opcional)</span>
                        <select th:field="*{syllabusId}">
                            <option value="">-- ninguno --</option>
                            <option th:each="sy : ${syllabi}" th:value="${sy.id}" th:text="${#strings.defaultString(sy.title, 'Temario')}"></option>
                        </select>
                    </label>
                </div>
                <button type="submit" class="btn primary">Crear tarea</button>
            </form>
        </section>
    </main>
</div>
</body>
</html>
